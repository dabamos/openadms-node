

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration &mdash; OpenADMS Node 0.7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="OpenADMS Node 0.7 documentation" href="index.html"/>
        <link rel="next" title="System Description" href="system.html"/>
        <link rel="prev" title="Running OpenADMS Node" href="running.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> OpenADMS Node
          

          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation of OpenADMS Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running OpenADMS Node</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-modules">Loading the Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-details">Project Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensor-node-details">Sensor Node Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication">Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensor">Sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#serial-port">Serial Port</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scheduler">Scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-processor">Pre-Processor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-exporter">File Exporter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complete-configuration-file">Complete Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-openadms">Running OpenADMS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="system.html">System Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="openadms-node-modules.html">OpenADMS Node Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OpenADMS Node</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>The monitoring system OpenADMS Node is configured by a single configuration file
in JavaScript Object Notation (JSON). The file is loaded once at the start of
OpenADMS Node. The path to the configuration file is passed as a command-line
argument. Example configuration files are located in directory
<code class="docutils literal"><span class="pre">config/examples/</span></code>. At the moment, configuration files have to be written
manually. This will change in future, once a visual configuration tool will be
available.</p>
<p>The configuration consists of several sections. The order of the sections is
arbitrary, but it is recommended to start with the core settings (<code class="docutils literal"><span class="pre">core</span></code>),
followed by the used sensors with their commands listed under <code class="docutils literal"><span class="pre">sensors</span></code>. See
directory <code class="docutils literal"><span class="pre">sensors/</span></code> for sensor configuration files. The configuration of
the dynamically loaded modules must be under <code class="docutils literal"><span class="pre">modules</span></code>.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;modules&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;myModule&quot;</span><span class="p">:</span> <span class="s2">&quot;modules.example.MyModule&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;project&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Example Project&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;4a2e8b9d87d849e38bb6911b9f2364ea&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Project for testing only.&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sensor Node 1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;6426bf58c20840768912f116740c4974&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The only sensor node in this project.&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;intercom&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;mqtt&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">1883</span><span class="p">,</span>
        <span class="s2">&quot;keepAlive&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="s2">&quot;openadms&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;sensors&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;mySensor&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;My Example Sensor&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;generic&quot;</span><span class="p">,</span>
      <span class="s2">&quot;observations&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;doMeasure&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Does a measurement.&quot;</span><span class="p">,</span>
          <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;point1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
          <span class="s2">&quot;onetime&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;receivers&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;preProcessor&quot;</span> <span class="p">],</span>
          <span class="s2">&quot;nextReceiver&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;requestSets&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;doMeasure&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
              <span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="s2">&quot;m</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span>
              <span class="s2">&quot;responsePattern&quot;</span><span class="p">:</span> <span class="s2">&quot;(?P&lt;x&gt;[+-]?</span><span class="se">\\</span><span class="s2">d+</span><span class="se">\\</span><span class="s2">.+</span><span class="se">\\</span><span class="s2">d)&quot;</span><span class="p">,</span>
              <span class="s2">&quot;responseDelimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span>
              <span class="s2">&quot;sleepTime&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
              <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="mf">1.0</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;requestsOrder&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;doMeasure&quot;</span> <span class="p">],</span>
          <span class="s2">&quot;responseSets&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span>
            <span class="p">}</span>
          <span class="p">},</span>
            <span class="s2">&quot;sleepTime&quot;</span><span class="p">:</span> <span class="mf">5.0</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;modules&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;myModule&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Geodetic inclinometers are not only used in industrial surveying but also in
deformation monitoring. This tutorial explains how the OpenADMS monitoring
system has to be configured in order to be used with a Leica Nivel210
inclinometer. More sensors can be added easily. This setup works on all
operating systems (Microsoft Windows, Linux, Unix).</p>
<p>The example requires a Leica Nivel210 inclinometer with data cable and
power supply unit, as well as a computer with an RS-232 port or USB serial
adapter.</p>
<p>Create an empty configuration file under <code class="docutils literal"><span class="pre">config/nivel210.json</span></code> and copy the
following JSON structure into it:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;modules&quot;</span><span class="p">:{</span> <span class="p">},</span>
    <span class="s2">&quot;project&quot;</span><span class="p">:{</span> <span class="p">},</span>
    <span class="s2">&quot;node&quot;</span><span class="p">:{</span> <span class="p">},</span>
    <span class="s2">&quot;intercom&quot;</span><span class="p">:{</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;sensors&quot;</span><span class="p">:{</span> <span class="p">},</span>
  <span class="s2">&quot;modules&quot;</span><span class="p">:{</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After that, fill the JSON objects and add further ones for the used modules.</p>
<div class="section" id="loading-the-modules">
<h3>Loading the Modules<a class="headerlink" href="#loading-the-modules" title="Permalink to this headline">¶</a></h3>
<p>Modules used for the monitoring job have to be added to the modules object in
the <code class="docutils literal"><span class="pre">core</span></code> section of the configuration file. For the control of a Leica
Nivel210 at least four modules are necessary:</p>
<ul class="simple">
<li><em>Scheduler</em> for starting the observation,</li>
<li><em>SerialPort</em> for sensor communication,</li>
<li><em>PreProcessor</em> for sensor data extraction,</li>
<li><em>FileExporter</em> to save the sensor data to a CSV file.</li>
</ul>
<p>The name of each module instance can be chosen freely. It is recommended to
write the names in lower camel case. As a common practice, the scheduler and
the serial port are named according to the used COM port (<code class="docutils literal"><span class="pre">COMx</span></code> on Microsoft
Windows and <code class="docutils literal"><span class="pre">ttyx</span></code> on Linux/Unix).</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;modules&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;schedulerCom1&quot;</span><span class="p">:</span><span class="s2">&quot;module.schedule.Scheduler&quot;</span><span class="p">,</span>
      <span class="s2">&quot;com1&quot;</span><span class="p">:</span><span class="s2">&quot;module.port.SerialPort&quot;</span><span class="p">,</span>
      <span class="s2">&quot;preProcessor&quot;</span><span class="p">:</span><span class="s2">&quot;module.processing.PreProcessor&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileExporter&quot;</span><span class="p">:</span><span class="s2">&quot;module.export.FileExporter&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>All modules listed in the modules object are loaded automatically at run-time.</p>
</div>
<div class="section" id="project-details">
<h3>Project Details<a class="headerlink" href="#project-details" title="Permalink to this headline">¶</a></h3>
<p>Some meta information about the monitoring project should be defined in the
<code class="docutils literal"><span class="pre">project</span></code> section of the configuration. For the project id, use a hex encoded
UUID4.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;project&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Example Project&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;19481e0791604b489a8a9c4a25e9dd80&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Project for testing the Leica Nivel210.&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sensor-node-details">
<h3>Sensor Node Details<a class="headerlink" href="#sensor-node-details" title="Permalink to this headline">¶</a></h3>
<p>Each project consists of one or more sensor nodes. It is required to set a
node name, a node id, and a node description. The node id should be a hex
encoded UUID4.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;node&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Sensor Node 1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;21bcf8c16a664b17bbc9cd4221fd8541&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;The only sensor node in this project.&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="communication">
<h3>Communication<a class="headerlink" href="#communication" title="Permalink to this headline">¶</a></h3>
<p>The communication between the single modules is based on the MQTT messaging
protocol. An MQTT message broker must be installed and running before
starting OpenADMS. The default configuration uses the IP address <code class="docutils literal"><span class="pre">127.0.0.1</span></code>
and the port <code class="docutils literal"><span class="pre">1883</span></code>, but can be altered to the values set for the used MQTT
message broker.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;intercom&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;mqtt&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span><span class="mi">1883</span><span class="p">,</span>
        <span class="s2">&quot;keepAlive&quot;</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span>
        <span class="s2">&quot;topic&quot;</span><span class="p">:</span><span class="s2">&quot;example&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sensor">
<h3>Sensor<a class="headerlink" href="#sensor" title="Permalink to this headline">¶</a></h3>
<p>Add the sensor details and used commands to the configuration file:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;sensors&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;nivel210&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Leica Nivel210&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;inclinometer&quot;</span><span class="p">,</span>
      <span class="s2">&quot;observations&quot;</span><span class="p">:[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;getValues&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;gets inclination and temperature&quot;</span><span class="p">,</span>
          <span class="s2">&quot;receivers&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;preProcessor&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fileExporter&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;nextReceiver&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
          <span class="s2">&quot;onetime&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;target&quot;</span><span class="p">:</span><span class="s2">&quot;nivel210&quot;</span><span class="p">,</span>
          <span class="s2">&quot;requestsOrder&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;getXYTemp&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;requestSets&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;getXYTemp&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
              <span class="s2">&quot;request&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x16</span><span class="se">\\</span><span class="s2">x02N0C0 G A</span><span class="se">\\</span><span class="s2">x03</span><span class="se">\\</span><span class="s2">x0d</span><span class="se">\\</span><span class="s2">x0a&quot;</span><span class="p">,</span>
              <span class="s2">&quot;response&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;responseDelimiter&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x03&quot;</span><span class="p">,</span>
              <span class="s2">&quot;responsePattern&quot;</span><span class="p">:</span><span class="s2">&quot;X:(?P[-+]?[0-9]*</span><span class="se">\\</span><span class="s2">.?[0-9]+) Y:(?P[-+]?[0-9]*</span><span class="se">\\</span><span class="s2">.?[0-9]+) T:(?P[-+]?[0-9]*</span><span class="se">\\</span><span class="s2">.?[0-9]+)&quot;</span><span class="p">,</span>
              <span class="s2">&quot;sleepTime&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
              <span class="s2">&quot;timeout&quot;</span><span class="p">:</span><span class="mf">1.0</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;responseSets&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;temperature&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span><span class="s2">&quot;C&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span><span class="s2">&quot;mrad&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span><span class="s2">&quot;mrad&quot;</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;sleepTime&quot;</span><span class="p">:</span><span class="mf">0.30</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="serial-port">
<h3>Serial Port<a class="headerlink" href="#serial-port" title="Permalink to this headline">¶</a></h3>
<p>The configuration of serial port modules is stored under <code class="docutils literal"><span class="pre">ports</span></code> → <code class="docutils literal"><span class="pre">serial</span></code>
→ <em>module name</em>. On Microsoft Windows, the port is <code class="docutils literal"><span class="pre">COMx</span></code>, on Linux and Unix
<code class="docutils literal"><span class="pre">/dev/ttyx</span></code> or <code class="docutils literal"><span class="pre">/dev/ttyUx</span></code>, whereas <code class="docutils literal"><span class="pre">x</span></code> is the number of the port. The
baud rate has to be set to the value the Nivel210 is configured to, most
likely <code class="docutils literal"><span class="pre">9600</span></code>.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;modules&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;ports&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;serial&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;com1&quot;</span><span class="p">:{</span>
          <span class="s2">&quot;port&quot;</span><span class="p">:</span><span class="s2">&quot;COM1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;baudRate&quot;</span><span class="p">:</span><span class="mi">9600</span><span class="p">,</span>
          <span class="s2">&quot;byteSize&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
          <span class="s2">&quot;stopBits&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;parity&quot;</span><span class="p">:</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
          <span class="s2">&quot;timeout&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span>
          <span class="s2">&quot;softwareFlowControl&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;hardwareFlowControl&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;maxAttepts&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="scheduler">
<h3>Scheduler<a class="headerlink" href="#scheduler" title="Permalink to this headline">¶</a></h3>
<p>Use a scheduler module to send commands to the sensor:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;modules&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;schedulers&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;schedulerCom1&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span><span class="s2">&quot;com1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensor&quot;</span><span class="p">:</span><span class="s2">&quot;nivel210&quot;</span><span class="p">,</span>
        <span class="s2">&quot;schedules&quot;</span><span class="p">:[</span>
          <span class="p">{</span>
            <span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;startDate&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;endDate&quot;</span><span class="p">:</span><span class="s2">&quot;2020-12-31&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weekdays&quot;</span><span class="p">:{</span> <span class="p">},</span>
            <span class="s2">&quot;observations&quot;</span><span class="p">:[</span>
              <span class="s2">&quot;getValues&quot;</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="pre-processor">
<h3>Pre-Processor<a class="headerlink" href="#pre-processor" title="Permalink to this headline">¶</a></h3>
<p>The PreProcessor is called right after the SerialPort module and extracts the
values (temperature, inclination in X and Y) from the raw response of the
Nivel210. The response pattern of the request set <code class="docutils literal"><span class="pre">getXYTemp</span></code> is used for the
extraction.</p>
</div>
<div class="section" id="file-exporter">
<h3>File Exporter<a class="headerlink" href="#file-exporter" title="Permalink to this headline">¶</a></h3>
<p>The name of the CSV file will be <code class="docutils literal"><span class="pre">com1_nivel210_2017-05.csv</span></code> or similar. The
CSV file is stored in the directory <code class="docutils literal"><span class="pre">data/</span></code>.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;modules&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;fileExporter&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;fileExtension&quot;</span><span class="p">:</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileName&quot;</span><span class="p">:</span><span class="s2">&quot;{{port}}_{{id}}_{{date}}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileRotation&quot;</span><span class="p">:</span><span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
      <span class="s2">&quot;paths&quot;</span><span class="p">:[</span>
        <span class="s2">&quot;./data&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;separator&quot;</span><span class="p">:</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateTimeFormat&quot;</span><span class="p">:</span><span class="s2">&quot;YYYY-MM-DDTHH:mm:ss.SSSSS&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="complete-configuration-file">
<h3>Complete Configuration File<a class="headerlink" href="#complete-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>The complete configuration is listed below.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;core&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;modules&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;schedulerCom1&quot;</span><span class="p">:</span><span class="s2">&quot;modules.schedule.Scheduler&quot;</span><span class="p">,</span>
      <span class="s2">&quot;com1&quot;</span><span class="p">:</span><span class="s2">&quot;modules.port.SerialPort&quot;</span><span class="p">,</span>
      <span class="s2">&quot;preProcessor&quot;</span><span class="p">:</span><span class="s2">&quot;modules.processing.PreProcessor&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileExporter&quot;</span><span class="p">:</span><span class="s2">&quot;modules.export.FileExporter&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;project&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Example Project&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;19481e0791604b489a8a9c4a25e9dd80&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Project for testing the Leica Nivel210.&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;node&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Sensor Node 1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;21bcf8c16a664b17bbc9cd4221fd8541&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;The only sensor node in this project.&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;intercom&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;mqtt&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span><span class="mi">1883</span><span class="p">,</span>
        <span class="s2">&quot;keepAlive&quot;</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span>
        <span class="s2">&quot;topic&quot;</span><span class="p">:</span><span class="s2">&quot;example&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;sensors&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;nivel210&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;Leica Nivel210&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;inclinometer&quot;</span><span class="p">,</span>
      <span class="s2">&quot;observations&quot;</span><span class="p">:[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;getValues&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;gets inclination and temperature&quot;</span><span class="p">,</span>
          <span class="s2">&quot;receivers&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;preProcessor&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fileExporter&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;nextReceiver&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
          <span class="s2">&quot;onetime&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;target&quot;</span><span class="p">:</span><span class="s2">&quot;nivel210&quot;</span><span class="p">,</span>
          <span class="s2">&quot;requestsOrder&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;getXYTemp&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;requestSets&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;getXYTemp&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
              <span class="s2">&quot;request&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x16</span><span class="se">\\</span><span class="s2">x02N0C0 G A</span><span class="se">\\</span><span class="s2">x03</span><span class="se">\\</span><span class="s2">x0d</span><span class="se">\\</span><span class="s2">x0a&quot;</span><span class="p">,</span>
              <span class="s2">&quot;response&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
              <span class="s2">&quot;responseDelimiter&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x03&quot;</span><span class="p">,</span>
              <span class="s2">&quot;responsePattern&quot;</span><span class="p">:</span><span class="s2">&quot;X:(?P[-+]?[0-9]*</span><span class="se">\\</span><span class="s2">.?[0-9]+) Y:(?P[-+]?[0-9]*</span><span class="se">\\</span><span class="s2">.?[0-9]+) T:(?P[-+]?[0-9]*</span><span class="se">\\</span><span class="s2">.?[0-9]+)&quot;</span><span class="p">,</span>
              <span class="s2">&quot;sleepTime&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
              <span class="s2">&quot;timeout&quot;</span><span class="p">:</span><span class="mf">1.0</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;responseSets&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;temperature&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span><span class="s2">&quot;C&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span><span class="s2">&quot;mrad&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
              <span class="s2">&quot;unit&quot;</span><span class="p">:</span><span class="s2">&quot;mrad&quot;</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;sleepTime&quot;</span><span class="p">:</span><span class="mf">0.30</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;modules&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;ports&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;serial&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;com1&quot;</span><span class="p">:{</span>
          <span class="s2">&quot;port&quot;</span><span class="p">:</span><span class="s2">&quot;COM1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;baudRate&quot;</span><span class="p">:</span><span class="mi">9600</span><span class="p">,</span>
          <span class="s2">&quot;byteSize&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
          <span class="s2">&quot;stopBits&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;parity&quot;</span><span class="p">:</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
          <span class="s2">&quot;timeout&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span>
          <span class="s2">&quot;softwareFlowControl&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;hardwareFlowControl&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;maxAttepts&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;schedulers&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;schedulerCom1&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span><span class="s2">&quot;com1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensor&quot;</span><span class="p">:</span><span class="s2">&quot;nivel210&quot;</span><span class="p">,</span>
        <span class="s2">&quot;schedules&quot;</span><span class="p">:[</span>
          <span class="p">{</span>
            <span class="s2">&quot;enabled&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;startDate&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;endDate&quot;</span><span class="p">:</span><span class="s2">&quot;2020-12-31&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weekdays&quot;</span><span class="p">:{</span>

            <span class="p">},</span>
            <span class="s2">&quot;observations&quot;</span><span class="p">:[</span>
              <span class="s2">&quot;getValues&quot;</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;fileExporter&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;fileExtension&quot;</span><span class="p">:</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileName&quot;</span><span class="p">:</span><span class="s2">&quot;{{port}}_{{id}}_{{date}}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileRotation&quot;</span><span class="p">:</span><span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
      <span class="s2">&quot;paths&quot;</span><span class="p">:[</span>
        <span class="s2">&quot;./data&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;separator&quot;</span><span class="p">:</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dateTimeFormat&quot;</span><span class="p">:</span><span class="s2">&quot;YYYY-MM-DDTHH:mm:ss.SSSSS&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="running-openadms">
<h3>Running OpenADMS<a class="headerlink" href="#running-openadms" title="Permalink to this headline">¶</a></h3>
<p>To start the monitoring, change to the OpenADMS directory and run the
following command from the command-line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python3 openadms.py --config config/nivel210.json --with-mqtt-broker --debug
</pre></div>
</div>
<p>On Microsoft Windows, you may want to use the graphical launcher instead.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="system.html" class="btn btn-neutral float-right" title="System Description" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="running.html" class="btn btn-neutral" title="Running OpenADMS Node" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Hochschule Neubrandenburg – University of Applied Sciences.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>